cscope 15 $HOME/work/bhc_work/GPSMapDemo               0000006856
	@geogpixsample.cpp

1 
	~"geogpix§m¶e.h
"

3 
	gGeogPixSam¶e
::
	$GeogPixSam¶e
(
_pix_x
,
_pix_y
,
_Êg
,
_Ït
)

5 
pix_x
 = 
_pix_x
;

6 
pix_y
 = 
_pix_y
;

7 
Êg
 = 
_Êg
;

8 
Ït
 = 
_Ït
;

9 
	}
}

	@geogpixsample.h

1 #iâdeà
GEOGPIXSAMPLE_H


2 
	#GEOGPIXSAMPLE_H


	)

3 
þass
 
	gGPSM­Mªag”
;

4 þas 
	cGeogPixSam¶e


6 
	mpix_x
;

7 
	mpix_y
;

8 
	mÊg
;

9 
	mÏt
;

10 
	mx_Êg_çùÜ_uµ”
;

11 
	my_Ït_çùÜ_uµ”
;

12 
	mx_Êg_çùÜ_und”
;

13 
	my_Ït_çùÜ_und”
;

14 
ä›nd
 
þass
 
	mGPSM­Mªag”
;

15 
	mpublic
:

16 
	$GeogPixSam¶e
(){}

17 
	`GeogPixSam¶e
(
_pix_x
,
_pix_y
,
_Êg
,
_Ït
);

18 
boÞ
 
Ý”©Ü
<(cÚ¡ 
GeogPixSam¶e
& 
§m¶e
){ 
Ït
<§m¶e.Ït;
	}
}

	@gpsmapmanager.cpp

1 
	~"gpsm­mªag”.h
"

2 
	~"geogpix§m¶e.h
"

4 
	gGPSM­Mªag”
::
	$GPSM­Mªag”
(cÚ¡ 
GeogPixSam¶e
& 
m­Sam¶e1
,cÚ¡ GeogPixSam¶e& 
m­Sam¶e2
)

7 
x_Êg_çùÜ
 = (
m­Sam¶e2
.
pix_x
 - 
m­Sam¶e1
.pix_xè/ (m­Sam¶e2.
Êg
 - mapSample1.lng);

8 
y_Ït_çùÜ
 = (
m­Sam¶e2
.
pix_y
 - 
m­Sam¶e1
.pix_yè/ (m­Sam¶e2.
Ït
 - mapSample1.lat);

9 
»fPošt
 = 
m­Sam¶e1
;

10 
	}
}

12 
	gGPSM­Mªag”
::
GPSM­Mªag”
(cÚ¡ 
¡d
::
veùÜ
<
GeogPixSam¶e
> &
_§m¶es
)

14 
_§m¶es
.
sÜt
();

15 
	gi
 = 0;˜< 
	g_§m¶es
.
size
() - 1;i++)

17 
	g_§m¶es
[
i
].
	gx_Êg_çùÜ_und”
 = (
_§m¶es
[i].
pix_x
 - _§m¶es[i+1].pix_x)/(_§m¶es[i].
Êg
 - _samples[i+1].lng);

18 
	g_§m¶es
[
i
].
	gy_Ït_çùÜ_und”
 = (
_§m¶es
[i].
pix_y
 - _§m¶es[i+1].pix_y)/(_§m¶es[i].
Ït
 - _samples[i+1].lat);

19 
	g_§m¶es
[
i
+1].
	gx_Êg_çùÜ_uµ”
 = 
_§m¶es
[i].
x_Êg_çùÜ_und”
;

20 
	g_§m¶es
[
i
+1].
	gy_Ït_çùÜ_uµ”
 = 
_§m¶es
[i].
y_Ït_çùÜ_und”
;

22 
	g_§m¶es
[0].
	gx_Êg_çùÜ_uµ”
 = 
_§m¶es
[0].
x_Êg_çùÜ_und”
;

23 
	g_§m¶es
[0].
	gy_Ït_çùÜ_uµ”
 = 
_§m¶es
[0].
y_Ït_çùÜ_und”
;

24 
	g_§m¶es
.
back
().
	gx_Êg_çùÜ_und”
 = 
_§m¶es
.back().
x_Êg_çùÜ_uµ”
;

25 
	g_§m¶es
.
back
().
	gy_Ït_çùÜ_und”
 = 
_§m¶es
.back().
y_Ït_çùÜ_uµ”
;

26 
	g§m¶es
 = 
_§m¶es
;

30 
QPoštF
 
	gGPSM­Mªag”
::
	$geog2pix
(
Êg
,
Ït
)

32 
x
 = 
»fPošt
.
pix_x
 + (
Êg
 -„efPošt.Êgè* 
x_Êg_çùÜ
;

33 
y
 = 
»fPošt
.
pix_y
 + (
Ït
 -„efPošt.Ïtè* 
y_Ït_çùÜ
;

34  
	`QPoštF
(
x
,
y
);

35 
	}
}

36 cÚ¡ 
	gGeogPixSam¶e
& 
	$fšdSam¶e
(
Êg
,
Ït
)

38 
§m¶es


39 
	}
}

	@gpsmapmanager.h

1 #iâdeà
GPSMAPMANAGER_H


2 
	#GPSMAPMANAGER_H


	)

3 
	~"geogpix§m¶e.h
"

4 
	~<QPoštF
>

5 
	~<veùÜ
>

6 þas 
	cGPSM­Mªag”


8 
	m¡d
::
veùÜ
<
GeogPixSam¶e
> 
§m¶eLi¡
;

9 
GeogPixSam¶e
 
	m»fPošt
;

10 
	mx_Êg_çùÜ
;

11 
	my_Ït_çùÜ
;

12 
	mpublic
:

13 
	$GPSM­Mªag”
(){}

14 
	`GPSM­Mªag”
(cÚ¡ 
¡d
::
li¡
<
GeogPixSam¶e
> &
_§m¶eLi¡
);

15 
GeogPixSam¶e
 
	`fšd
(
Êg
,
Ït
);

16 
QPoštF
 
	`geog2pix
(
Êg
,
Ït
);

17 cÚ¡ 
GeogPixSam¶e
& 
	`fšdSam¶e
(
Êg
,
Ït
);

18 
	}
};

	@main.cpp

1 
	~<QtGui/QAµliÿtiÚ
>

2 
	~"mašwšdow.h
"

4 
	$maš
(
¬gc
, *
¬gv
[])

6 
QAµliÿtiÚ
 
	`a
(
¬gc
, 
¬gv
);

7 
MašWšdow
 
w
;

8 
w
.
	`show
();

10  
a
.
	`exec
();

11 
	}
}

	@mainwindow.cpp

1 
	~"mašwšdow.h
"

2 
	~"ui_mašwšdow.h
"

3 
	~<QImage
>

4 
	~<QPaš‹r
>

5 
	~<QDebug
>

6 
	~"m­·Ãl.h
"

8 
	~"geogpix§m¶e.h
"

9 
	gMašWšdow
::
	$MašWšdow
(
QWidg‘
 *
·»Á
) :

10 
	`QMašWšdow
(
·»Á
),

11 
	`ui
(
Ãw
 
Ui
::
MašWšdow
)

14 
ui
->
	`£tupUi
(
this
);

15 
m­Pª–
 = 
Ãw
 
	`M­Pª–
("GPSM­.²g",
	`GPSM­Mªag”
(
	`GeogPixSam¶e
(1991,51,106.805015,-20.675571),GeogPixSam¶e(776,2730,100.120199,-6.423076)),
this
);

17 
QSŒšgLi¡
 
¡rLi¡
 = 
ui
->
lše_Êg
->
	`‹xt
().
	`¥l™
(
	`QCh¬
(','));

18 
m­Pª–
->
Êg
 = 
¡rLi¡
[1].
	`toDoubË
();

19 
m­Pª–
->
Ït
 = 
¡rLi¡
[0].
	`toDoubË
()*(-1);

21 
m­Pª–
->
	`»size
(800,800);

22 
m­Pª–
->
	`show
();

23 
	}
}

33 
	gMašWšdow
::~
	$MašWšdow
()

35 
d–‘e
 
ui
;

36 
d–‘e
 
m­Pª–
;

37 
	}
}

66 
	gMašWšdow
::
	$Ú_pushBu‰Ú_þicked
()

68 
QSŒšgLi¡
 
¡rLi¡
 = 
ui
->
lše_Êg
->
	`‹xt
().
	`¥l™
(
	`QCh¬
(','));

69 
m­Pª–
->
Êg
 = 
¡rLi¡
[1].
	`toDoubË
();

70 
m­Pª–
->
Ït
 = 
¡rLi¡
[0].
	`toDoubË
()*(-1);

71 
m­Pª–
->
	`upd©e
();

73 
	}
}

75 
	gMašWšdow
::
	$Ú_bŠ_up_þicked
()

77 
m­Pª–
->
off_y
 -= 100;

78 
m­Pª–
->
	`upd©e
();

79 
	}
}

81 
	gMašWšdow
::
	$Ú_bŠ_down_þicked
()

83 
m­Pª–
->
off_y
 += 100;

84 
m­Pª–
->
	`upd©e
();

85 
	}
}

87 
	gMašWšdow
::
	$Ú_bŠ_Ëá_þicked
()

89 
m­Pª–
->
off_x
 -= 100;

90 
m­Pª–
->
	`upd©e
();

91 
	}
}

93 
	gMašWšdow
::
	$Ú_bŠ_right_þicked
()

95 
m­Pª–
->
off_x
 += 100;

96 
m­Pª–
->
	`upd©e
();

97 
	}
}

99 
	gMašWšdow
::
	$Ú_bŠ_sÿË_add_þicked
()

101 
m­Pª–
->
sÿË
 += 0.1;

102 
m­Pª–
->
	`upd©e
();

103 
	}
}

105 
	gMašWšdow
::
	$Ú_bŠ_sÿË_sub_þicked
()

107 
m­Pª–
->
sÿË
 -= 0.1;

108 
m­Pª–
->
	`upd©e
();

109 
	}
}

111 
	gMašWšdow
::
	$Ú_push_dw_þicked
()

113 
m­Pª–
->
	`pos™iÚšg
();

114 
	}
}

	@mainwindow.h

1 #iâdeà
MAINWINDOW_H


2 
	#MAINWINDOW_H


	)

4 
	~<QMašWšdow
>

6 
Çme¥aû
 
	gUi
 {

7 
þass
 
	gMašWšdow
;

9 
þass
 
	gM­Pª–
;

10 þas 
	cMašWšdow
 : 
public
 
QMašWšdow


12 
Q_OBJECT


13 
M­Pª–
* 
m­Pª–
;

14 
	mpublic
:

15 
ex¶ic™
 
MašWšdow
(
QWidg‘
 *
·»Á
 = 0);

16 ~
MašWšdow
();

18 
´iv©e
 
	m¦Ùs
:

19 
Ú_pushBu‰Ú_þicked
();

21 
Ú_bŠ_up_þicked
();

23 
Ú_bŠ_down_þicked
();

25 
Ú_bŠ_Ëá_þicked
();

27 
Ú_bŠ_right_þicked
();

29 
Ú_bŠ_sÿË_add_þicked
();

31 
Ú_bŠ_sÿË_sub_þicked
();

33 
Ú_push_dw_þicked
();

35 
	m´iv©e
:

36 
Ui
::
MašWšdow
 *
ui
;

	@mappanel.cpp

1 
	~"m­·Ãl.h
"

2 
	~<QPaš‹r
>

3 
	gM­Pª–
::
	$M­Pª–
(cÚ¡ 
QSŒšg
& 
m­P©h
,cÚ¡ 
GPSM­Mªag”
& 
_m­Mªag”
,
QWidg‘
 *
·»Á
) :

4 
	`QWidg‘
(
·»Á
),
	`gpsM­
(
m­P©h
),
	$m­Magag”
(
_m­Mªag”
)

6 
off_x
 = 0;

7 
off_y
 = 0;

8 
sÿË
 = 1;

9 
	}
}

10 
	gM­Pª–
::
	$·štEv’t
(
QPaštEv’t
 *)

12 
QImage
 
	`img
("GPSMap.png");

14 
QPaš‹r
 
·š‹r
;

15 
·š‹r
.
	`begš
(&
img
);

16 
QP’
 
	`³n
(
·š‹r
.pen());

17 
³n
.
	`£tWidth
(10);

18 
³n
.
	`£tCÞÜ
(
	`QCÞÜ
(
Qt
::
»d
));

19 
·š‹r
.
	`£tP’
(
³n
);

21 
·š‹r
.
	`d¿wPošt
(
m­Magag”
.
	`geog2pix
(
Êg
,
Ït
));

25 
·š‹r
.
	`’d
();

26 
·š‹r
.
	`begš
(
this
);

27 
·š‹r
.
	`”a£Reù
(0,0,
	`width
(),
	`height
());

28 
·š‹r
.
	`Œª¦©e
(
off_x
,
off_y
);

29 
·š‹r
.
	`sÿË
(
sÿË
,scale);

30 
·š‹r
.
	`d¿wImage
(0,0,
img
);

31 
·š‹r
.
	`’d
();

32 
	}
}

33 
	gM­Pª–
::
	$pos™iÚšg
()

35 
sÿË
 = 1;

36 
off_x
 = 
	`width
()/2 - 
m­Magag”
.
	`geog2pix
(
Êg
,
Ït
).
	`x
();

37 
off_y
 = 
	`height
()/2 - 
m­Magag”
.
	`geog2pix
(
Êg
,
Ït
).
	`y
();

38 
	`upd©e
();

39 
	}
}

	@mappanel.h

1 #iâdeà
MAPPANEL_H


2 
	#MAPPANEL_H


	)

4 
	~<QWidg‘
>

5 
	~"gpsm­mªag”.h
"

6 þas 
	cM­Pª–
 : 
public
 
QWidg‘


8 
Q_OBJECT


9 
GPSM­Mªag”
 
m­Magag”
;

10 
QImage
 
	mgpsM­
;

11 
	mpublic
:

12 
off_x
;

13 
	moff_y
;

14 
	msÿË
;

15 
	mÊg
;

16 
	mÏt
;

18 
	mpublic
:

19 
ex¶ic™
 
M­Pª–
(cÚ¡ 
QSŒšg
& 
m­P©h
,cÚ¡ 
GPSM­Mªag”
& 
_m­Mªag”
,
QWidg‘
 *
·»Á
 = 0);

20 
pos™iÚšg
();

21 
	msigÇls
:

23 
public
 
¦Ùs
:

24 
´iv©e
:

25 
·štEv’t
(
QPaštEv’t
 *);

	@
1
.
1
/usr/include
9
129
geogpixsample.cpp
geogpixsample.h
gpsmapmanager.cpp
gpsmapmanager.h
main.cpp
mainwindow.cpp
mainwindow.h
mappanel.cpp
mappanel.h
